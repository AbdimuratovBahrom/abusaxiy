


<div class="search-form" style="margin-top: 20px;">
 <input type="text" id="searchInput" placeholder="–ü—Ä–∏–º–µ—Ä—ã: 1-a-6 | 2 p 25 | –≥ 52 | –æ—Ñ–∏—Å | —Ç—É–∞–ª–µ—Ç">
  <datalist id="suggestions"></datalist>
  <button type="button" onclick="performSearch()">üîç –ù–∞–π—Ç–∏</button>
</div>
<div id="searchResults" style="margin-top: 15px; padding: 15px; background: #f0fff4; border-left: 5px solid #10b981; border-radius: 8px; min-height: 60px;"></div>









// ================================================
// –ü–û–ò–°–ö ‚Äî 100% –†–ê–ë–û–ß–ê–Ø –í–ï–†–°–ò–Ø (–¢–û–ß–ù–û –ò–°–ü–†–ê–í–õ–ï–ù–û)
// ================================================

function normalizeQuery(q) {
  return q.trim().toLowerCase().replace(/[^a-z–∞-—è0-9\s-]/gi, ' ');
}

function performSearch() {
  let rawQuery = searchInput.value.trim();
  if (!rawQuery) {
    searchResults.innerHTML = '<span style="color:#666;">–ü—Ä–∏–º–µ—Ä—ã: 1-f-56 | 3-1-50 | 2-p-78 | –≥-269 | —Ç—É–∞–ª–µ—Ç</span>';
    return;
  }

  const query = normalizeQuery(rawQuery);
  const hasG = /–≥|g/i.test(rawQuery); // –ï—Å—Ç—å –ª–∏ –ì/g/G

  searchResults.innerHTML = '<div>–ü–æ–∏—Å–∫: <strong>' + rawQuery + '</strong>...</div><br>';

  const results = [];

  // 1. –ï—Å–ª–∏ –µ—Å—Ç—å –ì/g/G ‚Üí –¢–û–õ–¨–ö–û –ì–∏–ø–µ—Ä–º–∞—Ä–∫–µ—Ç + –ø–æ–∏—Å–∫ –ø–æ –Ω–æ–º–µ—Ä—É –º–∞–≥–∞–∑–∏–Ω–∞
  if (hasG && DATA["–ì–∏–ø–µ—Ä–º–∞—Ä–∫–µ—Ç"]?.paths) {
    const digits = rawQuery.match(/\d+/g)?.join('') || '';

    DATA["–ì–∏–ø–µ—Ä–º–∞—Ä–∫–µ—Ç"].paths.forEach(item => {
      item.shops.forEach(shop => {
        const s = shop.trim();
        const sLower = s.toLowerCase();

        // –ï—Å–ª–∏ –≤ –∑–∞–ø—Ä–æ—Å–µ —Ü–∏—Ñ—Ä—ã ‚Äî –∏—â–µ–º –∏—Ö + –Ω–∞–ª–∏—á–∏–µ g/–≥
        if (digits && s.includes(digits) && (sLower.includes('g') || sLower.startsWith('g'))) {
          let path = item.path.trim();
          if (!path.endsWith(s)) path += ` > ${s}`;
          results.push(`<strong>${path}</strong> (–ì–∏–ø–µ—Ä–º–∞—Ä–∫–µ—Ç)`);
        }
      });
    });
  }

  // 2. –ü–æ–∏—Å–∫ –ø–æ 1,2,3 –±–ª–æ–∫–∞–º (–µ—Å–ª–∏ –ù–ï –±—ã–ª–æ –ì/g)
  if (!hasG) {
    // –ü–∞—Ä—Å–∏–º –∑–∞–ø—Ä–æ—Å: –ø–µ—Ä–≤–∞—è —Ü–∏—Ñ—Ä–∞ ‚Äî –±–ª–æ–∫, –ø–µ—Ä–≤–∞—è –±—É–∫–≤–∞ ‚Äî —Ä—è–¥, –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Ü–∏—Ñ—Ä—ã ‚Äî –º–∞–≥–∞–∑–∏–Ω
    const parts = rawQuery.split(/[\s,-;]+/).filter(p => p.trim());

    let blockNum = null;
    let rowLetter = null;
    let shopNum = null;

    parts.forEach(p => {
      if (/^\d+$/.test(p)) {
        if (!blockNum) blockNum = p; // –ø–µ—Ä–≤–∞—è —Ü–∏—Ñ—Ä–∞ ‚Äî –±–ª–æ–∫
        else shopNum = p; // –≤—Å–µ –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ —Ü–∏—Ñ—Ä—ã ‚Äî –º–∞–≥–∞–∑–∏–Ω
      } else if (/^[a-z–∞-—è]$/i.test(p)) {
        rowLetter = p.toUpperCase(); // –±—É–∫–≤–∞ ‚Äî —Ä—è–¥
      }
    });

    if (blockNum) {
      const targetBlock = `${blockNum}-–±–ª–æ–∫`.toLowerCase();

      Object.entries(DATA).forEach(([blockName, data]) => {
        if (blockName.toLowerCase().includes(targetBlock) && data.paths) {
          data.paths.forEach(item => {
            const pathLower = item.path.toLowerCase();

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä—è–¥–∞ (–µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω)
            const hasRow = rowLetter ? pathLower.includes(`—Ä—è–¥ ${rowLetter.toLowerCase()}`) : true;

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∞–≥–∞–∑–∏–Ω–∞ ‚Äî —Å—Ç—Ä–æ–≥–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –Ω–æ–º–µ—Ä–∞
            const hasShop = shopNum ? item.shops.some(s => s.trim() === shopNum) : true;

            if (hasRow && hasShop) {
              const shopDisplay = shopNum || (item.shops.length > 0 ? item.shops[0] : '?');
              let path = item.path.trim();
              if (!path.endsWith(shopDisplay)) path += ` > ${shopDisplay}`;
              results.push(`<strong>${path}</strong> (${blockName})`);
            }
          });
        }
      });
    }
  }

  // 3. –ü–æ–∏—Å–∫ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º (–µ—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞—à–ª–∏)
  if (results.length === 0) {
    Object.entries(DATA).forEach(([blockName, blockData]) => {
      if (!blockData.paths) return;

      blockData.paths.forEach(item => {
        item.shops.forEach(shop => {
          const s = shop.toLowerCase();
          if (s.includes(query) || item.path.toLowerCase().includes(query)) {
            let path = item.path.trim();
            if (!path.endsWith(shop)) path += ` > ${shop}`;
            results.push(`<strong>${path}</strong> (${blockName})`);
          }
        });
      });
    });
  }

  // –í—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
  if (results.length === 0) {
    searchResults.innerHTML += `<span style="color:#e53e3e;">–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –ø–æ –∑–∞–ø—Ä–æ—Å—É "${rawQuery}"</span><br>
      <small>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ: 1-f-56 | 3-1-50 | 2-p-78 | –≥-269 | —Ç—É–∞–ª–µ—Ç</small>`;
  } else {
    searchResults.innerHTML += results.join('<br><br>');
  }
}

// –ó–∞–ø—É—Å–∫ –ø–æ–∏—Å–∫–∞
document.querySelector('.search-form button')?.addEventListener('click', performSearch);

searchInput.addEventListener('keypress', function(e) {
  if (e.key === 'Enter') {
    e.preventDefault();
    performSearch();
  }
});





